# MCDA Core v0.9 执行计划

**版本**: v0.9 - 用户优化版本
**创建日期**: 2026-02-05
**状态**: 📋 规划中
**预计工期**: 7.5-8 人日
**优先级**: P1
**依赖版本**: v0.8.1

---

## 📊 版本定位

**v0.9 = CSV/Excel 导入 + 可视化增强 + CLI 优化**

**策略**: 优先实现数据导入功能（P0），增强用户体验（P1）

**版本演进**:
```
v0.8.1 ✅ 文档补充
  ↓
v0.9 🚀 用户优化（CSV/Excel 导入 + 可视化 + CLI 优化）
  ↓
v1.0 生产就绪（Web UI + API）
```

---

## 🎯 核心目标

### 主要目标

1. **CSV/Excel 数据导入**（P0）- 新增功能
   - 支持 CSV 格式导入
   - 支持 Excel 格式导入
   - 支持区间数格式
   - 完善的错误处理

2. **可视化增强**（P1）
   - 结果图表生成
   - 敏感性分析可视化

3. **CLI 基础优化**（P1）
   - 命令行参数优化
   - 错误提示优化

4. **Markdown 报告模板**（P2）
   - 基础报告模板

5. **文档归档**（P2）
   - v0.8 文档归档

---

## 📋 功能清单（按优先级排序）

| 功能 | 优先级 | 工期 | 状态 | 依赖 |
|------|--------|------|------|------|
| **CSV/Excel 数据导入** | P0 | 3人日 | 📋 待执行 | 无 |
| ├─ CSV Loader 实现 | P0 | 0.5人日 | 📋 待执行 | 无 |
| ├─ Excel Loader 实现 | P0 | 1.5人日 | 📋 待执行 | openpyxl |
| ├─ 格式验证和错误处理 | P0 | 0.5人日 | 📋 待执行 | CSV/Excel Loader |
| └─ 测试和文档 | P0 | 0.5人日 | 📋 待执行 | 上述功能 |
| **可视化增强** | P1 | 2人日 | 📋 待执行 | 无 |
| ├─ 结果图表生成 | P1 | 1人日 | 📋 待执行 | matplotlib |
| ├─ 敏感性分析可视化 | P1 | 1人日 | 📋 待执行 | matplotlib |
| **CLI 基础优化** | P1 | 1人日 | 📋 待执行 | 无 |
| ├─ 命令行参数优化 | P1 | 0.5人日 | 📋 待执行 | click/argparse |
| └─ 错误提示优化 | P1 | 0.5人日 | 📋 待执行 | 上述功能 |
| **Markdown 报告模板** | P2 | 1人日 | 📋 待执行 | 无 |
| **文档归档** | P2 | 0.5人日 | 📋 待执行 | 无 |

**总工期**: 7.5-8 人日

---

## 📝 详细任务分解

### Phase 1: CSV/Excel 数据导入（3 人日）

#### 任务 1.1: CSV Loader 实现（0.5 人日）

**目标**: 实现 CSV 格式配置文件加载器

**文件**: `skills/mcda-core/lib/loaders/csv_loader.py`

**CSV 格式约定**:
```csv
方案A,方案B,方案C
性能,0.4,higher,85,90,88
成本,0.3,lower,50,60,55
可靠性,0.2,higher,90,85,92
易用性,0.1,higher,80,75,78
```

**约定说明**:
- 第一行: 备选方案名称（逗号分隔）
- 后续行: 准则数据
- 列结构: [准则名称, 权重, 方向, 方案1得分, 方案2得分, ...]

**验收标准**:
- [ ] 支持标准 CSV 格式
- [ ] 支持区间数格式（"a,b" 或 "[a,b]"）
- [ ] 正确解析备选方案、准则、评分
- [ ] 单元测试覆盖率 ≥ 85%

#### 任务 1.2: Excel Loader 实现（1.5 人日）

**目标**: 实现 Excel 格式配置文件加载器

**文件**: `skills/mcda-core/lib/loaders/excel_loader.py`

**Excel 模板设计**:

**Sheet1: 决策矩阵**
```
┌─────────┬─────────┬─────────┬─────────┬─────────┐
│         │ 权重    │ 方向    │ 方案A   │ 方案B   │
├─────────┼─────────┼─────────┼─────────┼─────────┤
│ 性能    │ 0.4     │ higher  │ 85      │ 90      │
│ 成本    │ 0.3     │ lower   │ 50      │ 60      │
│ 可靠性  │ 0.2     │ higher  │ 90      │ 85      │
│ 易用性  │ 0.1     │ higher  │ 80      │ 75      │
└─────────┴─────────┴─────────┴─────────┴─────────┘
```

**验收标准**:
- [ ] 支持 .xlsx 格式
- [ ] 支持区间数格式
- [ ] 支持多 Sheet 读取
- [ ] 单元测试覆盖率 ≥ 85%

#### 任务 1.3: 格式验证和错误处理（0.5 人日）

**目标**: 完善格式验证和错误处理

**验收标准**:
- [ ] 所有错误都有清晰的错误信息
- [ ] 指出错误的具体位置（行/列）
- [ ] 提供修复建议

#### 任务 1.4: 测试和文档（0.5 人日）

**目标**: 完善测试和文档

**验收标准**:
- [ ] 单元测试覆盖率 ≥ 85%
- [ ] 集成测试通过
- [ ] 文档完整清晰

---

## 🎯 验收标准

### 功能验收
- [ ] 可以从 CSV 加载决策问题
- [ ] 可以从 Excel 加载决策问题
- [ ] 支持区间数格式（"a,b" 或 "[a,b]"）
- [ ] 格式错误时提供清晰的错误信息
- [ ] 提供 CSV/Excel 模板文档
- [ ] 单元测试覆盖率 ≥ 85%
- [ ] 集成测试通过

### 质量验收
- [ ] 代码规范符合 PEP 8
- [ ] 类型注解 100% 覆盖
- [ ] 文档字符串完整
- [ ] 错误处理完善

---

**计划状态**: 📋 等待用户确认

**请确认**: 此计划是否符合您的预期？确认后我们将立即开始执行！🚀
