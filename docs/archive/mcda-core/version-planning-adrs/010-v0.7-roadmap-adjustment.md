# ADR-010: v0.7 版本规划调整决策

## 状态
**已接受 (Accepted)**

## 日期
2026-02-04

## 上下文 (Context)

### 当前状态

**v0.6 已完成** ✅ (2026-02-04)
- 群决策基础模型 (DecisionMaker, GroupDecisionProblem)
- PCA 主成分分析赋权
- 高级聚合方法 (Borda Count, Copeland, 加权几何平均)
- 德尔菲法 (Delphi Method)
- 共识度测量
- 群决策服务

**测试统计**: 153 个测试, 100% 通过率, 92% 覆盖率

**代码量**: ~342 行实现, 153 个测试

### 原规划问题

经过架构师审查 (architect agent, 2026-02-04),发现以下问题:

**问题1: ADR-007 与实际执行不一致** 🔴
- ADR-007 Phase 2 规划: **模糊数基础** (v0.6)
- 实际 v0.6 执行: **群决策功能**
- **偏离原因**: 用户需求调整,群决策优先级更高

**问题2: v0.7 工作量被严重低估** 🔴
- 原计划工期: 15 人日
- 实际分析: 19-24 人日
- **低估幅度**: 27-60%

**问题3: 功能优先级不明确** 🟡
- v0.7 规划: TODIM/ELECTRE-I/PROMETHEE 区间版本 + 模糊数基础
- 模糊数是**依赖项**,但优先级却低于区间版本
- **逻辑顺序错误**

**问题4: 缺少关键技术验证** 🟡
- ELECTRE-I 区间核提取 - 学术支持不足
- PROMETHEE 区间偏好函数 - 技术难度高
- 可能度排序 - 原型未验证

---

## 决策 (Decision)

### 1. 明确 v0.7 功能范围

#### 方案对比

| 方案 | 优点 | 缺点 | 工期 | 决策 |
|------|------|------|------|------|
| **A: 聚焦核心算法** | VIKOR+可能度+TODIM<br>风险可控,工期合理 | ELECTRE-I/PROMETHEE延迟 | 11人日 | ✅ 采用 |
| **B: 聚焦模糊数** | 完成ADR-007 Phase2<br>建立模糊数基础 | 区间扩展不完整 | 13人日 | ⚠️ 备选 |
| **C: 原计划** | 功能完整 | 工作量大(19-24人日)<br>风险高 | 15人日(低估) | ❌ |

**决策**: **方案 A - 聚焦核心算法区间扩展**

**理由**:
1. **补全 VIKOR**: v0.5 新算法,优先补全区间版本
2. **可能度排序**: 比中点法更精确,提升排序质量
3. **TODIM 价值**: 前景理论在区间数下有意义
4. **风险可控**: 工期合理,技术可行性高

---

### 2. v0.7 功能清单调整

#### 调整后的功能范围

| 优先级 | 功能 | 工期 | 说明 | 依赖 |
|--------|------|------|------|------|
| **P0** | **Phase 0: 技术验证** | 2人日 | VIKOR可行性+可能度原型+ELECTRE-I调研 | - |
| **P0** | **VIKOR 区间版本** | 3人日 | 折衷排序法区间版本 | Phase 0 |
| **P1** | **可能度排序** | 4人日 | P(A≥B)计算,比中点法更精确 | Phase 0 |
| **P2** | **TODIM 区间版本** | 4人日 | 前景理论+区间数融合 | 可能度排序 |
| **P1** | **集成与文档** | 2人日 | 测试+文档+性能优化 | Phase 1-3 |
| P3 | ELECTRE-I 区间版本 | - | 延迟到 v0.9 | - |
| P3 | PROMETHEE 区间版本 | - | 延迟到 v0.9 | - |
| P3 | **模糊数基础** | - | 延迟到 v0.8 | - |

**总工作量**: **11 人日** (vs 原计划 15 人日)

**节省**: 4 人日 (27%)

---

### 3. 引入技术验证阶段

**决策**: 新增 **Phase 0: 技术验证** (2 人日)

#### 验证内容

**VIKOR 区间可行性**:
- 区间群体效用 S 计算方法
- 区间个别遗憾 R 计算方法
- 区间折衷值 Q 计算方法
- 排序策略确定

**可能度排序原型**:
- P(A ≥ B) 计算公式验证
- 综合可能度排序算法
- 边界条件测试

**ELECTRE-I 区间调研**:
- 查找学术论文
- 区间和谐指数计算方法
- 区间核提取算法
- 技术风险评估

#### 决策树

```
验证通过 → 按方案A实施 v0.7
部分失败 → 调整范围,降低风险
全部失败 → 重新规划 v0.7
```

---

### 4. 功能优先级重新排序

#### 基于用户价值和技术可行性

| 算法 | 用户需求 | 技术难度 | 学术支持 | 推荐优先级 | v0.7 |
|------|---------|---------|---------|-----------|------|
| VIKOR 区间版本 | ⭐⭐⭐⭐⭐ | 🟢 低 | ✅ 充足 | **P0** | ✅ |
| 可能度排序 | ⭐⭐⭐⭐ | 🟡 中 | ✅ 充足 | **P1** | ✅ |
| TODIM 区间版本 | ⭐⭐⭐ | 🟡 中 | ⚠️ 有限 | P2 | ✅ |
| ELECTRE-I 区间版本 | ⭐⭐ | 🔴 高 | ❌ 稀少 | P3 | ❌ 延迟 |
| PROMETHEE 区间版本 | ⭐⭐ | 🔴 高 | ❌ 稀少 | P3 | ❌ 延迟 |
| TOPSIS 模糊版本 | ⭐⭐⭐⭐ | 🟡 中 | ✅ 充足 | P1 | ❌ 延迟到 v0.8 |
| TriangularFuzzy 类型 | ⭐⭐⭐ | 🟡 中 | ✅ 充足 | P2 | ❌ 延迟到 v0.8 |

**结论**:
- **优先实现**: VIKOR + 可能度 + TODIM
- **延迟**: ELECTRE-I/PROMETHEE → v0.9
- **延迟**: 模糊数基础 → v0.8

---

### 5. 工期重新估算

#### 保守估算

| 阶段 | 乐观 | 预期 | 保守 |
|------|------|------|------|
| Phase 0: 技术验证 | 1.5 | 2 | 3 |
| Phase 1: VIKOR 区间版本 | 2.5 | 3 | 4 |
| Phase 2: 可能度排序 | 3 | 4 | 6 |
| Phase 3: TODIM 区间版本 | 3 | 4 | 6 |
| Phase 4: 集成与文档 | 1.5 | 2 | 3 |
| **总计** | **11.5** | **15** | **22** |

#### 建议工期

**推荐**: **11 人日** (约 2.5 周)

**理由**:
- 预期估算,平衡乐观和保守
- Phase 0 技术验证降低风险
- 聚焦核心,功能范围缩减

**风险控制**:
- 如果延迟,可拆分 v0.7.1 (只包含 VIKOR + 可能度)
- TODIM 区间版本可延迟到 v0.8
- 预留 20% 缓冲时间

---

## 权衡分析 (Trade-offs)

### 决策1: v0.7 功能范围

| 方案 | 优点 | 缺点 | 决策 |
|------|------|------|------|
| **原计划(全部算法区间版本)** | 功能完整<br>一步到位 | 工作量大(19-24人日)<br>风险高<br>工期长 | ❌ |
| **聚焦核心(VIKOR+可能度+TODIM)** | 风险可控<br>工期合理(11人日)<br>补全核心功能 | ELECTRE-I/PROMETHEE延迟<br>功能不完整 | ✅ 采用 |
| **聚焦模糊数** | 完成ADR-007 Phase2<br>建立模糊数基础 | 区间扩展不完整<br>VIKOR区间版本缺失 | ⚠️ 备选 |

**决策**: 聚焦核心(VIKOR+可能度+TODIM),工期11人日

### 决策2: 是否引入技术验证阶段

| 方案 | 优点 | 缺点 | 决策 |
|------|------|------|------|
| **直接开发** | 节省2人日<br>快速启动 | 风险未知<br>可能返工 | ❌ |
| **技术验证优先** | 降低风险<br>明确可行性<br>有应急方案 | 增加2人日 | ✅ 采用 |

**决策**: 引入 Phase 0 技术验证

### 决策3: ELECTRE-I/PROMETHEE 区间版本

| 方案 | 优点 | 缺点 | 决策 |
|------|------|------|------|
| **v0.7 全部实现** | 功能完整 | 工作量大(8-10人日)<br>学术支持不足<br>技术风险高 | ❌ |
| **延迟到 v0.8** | 降低风险 | 延迟用户需求 | ⚠️ |
| **延迟到 v0.9** | 充分调研<br>技术验证 | 延迟更久 | ✅ 采用 |

**决策**: ELECTRE-I/PROMETHEE 区间版本延迟到 v0.9

### 决策4: 模糊数基础实施时机

| 方案 | 优点 | 缺点 | 决策 |
|------|------|------|------|
| **v0.7 实施** | 完成ADR-007 Phase2 | 工期紧张<br>区间扩展不完整 | ❌ |
| **v0.8 实施** | 区间扩展完整<br>工期充裕 | 模糊数延迟 | ✅ 采用 |

**决策**: 模糊数基础延迟到 v0.8

---

## 后果 (Consequences)

### 正面影响 ✅

1. **聚焦核心价值**: VIKOR + 可能度 + TODIM
2. **风险可控**: Phase 0 技术验证,工期合理
3. **质量保证**: 充分测试,覆盖率 >= 85%
4. **向后兼容**: 不影响现有功能
5. **工期节省**: 11 人日 vs 原计划 15 人日

### 负面影响 ⚠️

1. **功能不完整**: ELECTRE-I/PROMETHEE 区间版本延迟
2. **模糊数延迟**: ADR-007 Phase 2 延迟到 v0.8
3. **用户等待**: 部分功能需要等待 v0.8/v0.9
4. **文档更新**: 需要更新所有相关文档

### 缓解措施 🛡️

1. **透明沟通**: 在文档中明确说明 v0.7 范围
2. **快速迭代**: v0.7 完成后立即开始 v0.8
3. **用户反馈**: 根据用户反馈调整优先级
4. **灵活调整**: 如果延迟,可拆分 v0.7.1

---

## 未来演进

### v0.7: 渐进式扩展 (11 人日) ✅ 当前版本

**核心功能**:
- Phase 0: 技术验证 (2人日)
- Phase 1: VIKOR 区间版本 (3人日)
- Phase 2: 可能度排序 (4人日)
- Phase 3: TODIM 区间版本 (4人日)
- Phase 4: 集成与文档 (2人日)

**交付物**:
- 2 个算法区间版本 (VIKOR, TODIM)
- 可能度排序方法
- 108 个测试
- 完整文档

### v0.8: 模糊数基础 (7-8 人日) 📋 已规划

**核心功能**:
- TriangularFuzzy 数据类型
- 模糊算术运算
- TOPSIS 模糊版本
- 重心法去模糊

### v0.9: 可选扩展 (按需)

**可选功能**:
- ELECTRE-I 区间版本（如果学术支持充足）
- PROMETHEE 区间版本（如果学术支持充足）
- 其他算法模糊版本

---

## 成功标准

### v0.7 验收标准

**功能完整性**:
- [ ] VIKOR 区间版本实现并测试通过
- [ ] TODIM 区间版本实现并测试通过
- [ ] 可能度排序实现并集成
- [ ] 与现有算法兼容

**质量指标**:
- [ ] 测试覆盖率 >= 85%
- [ ] 测试通过率 100% (108/108)
- [ ] 执行时间: VIKOR < 0.5s, TODIM < 0.5s
- [ ] 代码质量: 类型注解 100%, 文档字符串 100%

**文档完整性**:
- [ ] API 文档完整
- [ ] 数学模型说明清晰
- [ ] 使用示例充分
- [ ] README 更新

**性能指标**:
- [ ] 10 方案 × 10 准则 < 1 秒
- [ ] 50 方案 × 20 准则 < 5 秒
- [ ] 可能度排序: 10 个区间 < 0.1 秒

---

## 参考资料

### 相关 ADR
- [ADR-007: 区间数/模糊数 MCDA 架构设计](./007-interval-fuzzy-mcda-architecture.md)
- [ADR-009: v0.5 版本规划调整](./009-v0.5-roadmap-adjustment.md)

### 规划文档
- [v0.7 执行计划](../plans/mcda-core/v0.7/execution-plan.md)
- [roadmap-complete.md](../plans/mcda-core/roadmap-complete.md)

### 架构评估
- architect agent 评估报告 (2026-02-04)

---

## 变更历史

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2026-02-04 | v1.0 | 初始版本,记录 v0.7 规划调整决策 | AI architect |

---

**决策者**: hunkwk + AI architect agent
**批准日期**: 2026-02-04
**状态**: ✅ 已接受
**预计工期**: 11 人日 (2.5 周)
**比原计划节省**: 4 人日 (27%)

**🎯 关键决策**:
1. v0.7 聚焦核心(VIKOR+可能度+TODIM)
2. 引入 Phase 0 技术验证
3. ELECTRE-I/PROMETHEE 延迟到 v0.9
4. 模糊数基础延迟到 v0.8
5. 工期调整为 11 人日
